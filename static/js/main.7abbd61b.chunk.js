(this.webpackJsonpflowskip=this.webpackJsonpflowskip||[]).push([[0],{39:function(e,n,t){"use strict";t.r(n);var o,a=t(0),r=t.n(a),i=t(19),c=t.n(i),s=t(23),l=t(4),d=t(2),p=t(5),u=t(3),g="https://flowskip-api.herokuapp.com",m="user",h="room",b="API !=! failed to fetch api, reason ";function j(e){var n={},t=new Headers;return t.append("Content-Type","application/json"),t.append("Authorization","Bearer "+localStorage.getItem("session_key")),n.method=e,n.headers=t,n.withCredentials=!0,n.credentials="include",n}function f(e){var n=new URL([g,m,"session","start"].join("/")),t=j("POST");fetch(n,t).then((function(e){return e.json()})).then((function(n){localStorage.setItem("session_key",n.session_key),e(!0)})).catch((function(e){return new Error(b+e)})),console.log("API !=! Getting session key")}function x(e){var n=new URL([g,m,"create"].join("/")),t=j("POST");fetch(n,t).then((function(n){201===n.status?(console.log("API !=! user created"),localStorage.setItem("user_created",!0),e(!0)):208===n.status?(console.log("API !=! user already exists"),localStorage.setItem("user_created",!0),e(!0)):new Error("API !=! user not created, response = "+n.status)})).catch((function(e){return new Error(b+e)}))}function O(e){var n={redirect_url:"https://flowskip.com/redirect-from-api"},t=new URL([g,"spotify","authenticate-user"].join("/"));t.search=new URLSearchParams(n).toString();var o=j("GET");console.log("Getting url"),console.log(localStorage.getItem("session_key")),fetch(t,o).then((function(e){return 208===e.status&&localStorage.setItem("spotify_authenticated","true"),e.json()})).then((function(n){void 0===n.authorize_url?(localStorage.removeItem("next"),e("208")):e(n.authorize_url)})).catch((function(e){return new Error(b+e)}))}var v,w,y,S,k,_,I,E,B=u.c.button(o||(o=Object(d.a)(["\n  height: 80%;\n  max-height: 80px;\n  border-radius: 10px;\n  font-size: 1.6rem;\n  line-height: 1.6rem;\n  background-color: var(--purple);\n  color: white;\n  font-family: var(--font-bungee-bold);\n  border: none;\n  box-shadow: 5px 5px 10px 5px #00000033;\n  padding: 5px 20px;\n  cursor: pointer;\n  transition: 0.3s;\n  width: 100%;\n  max-width: 300px;\n  text-decoration: none;\n  display: flex;\n  justify-self: center;\n  justify-content: center;\n  align-items: center;\n  opacity: 0.9;\n\n  &:active {\n    transform: scale(0.9);\n    opacity: 1;\n  }\n\n  &:hover {\n    filter: brightness(120%);\n    opacity: 1;\n  }\n"]))),C=t.p+"static/media/logo.97f0d8b3.png",T=t(1),L=null!==localStorage.getItem("session_key"),z="true"===localStorage.getItem("user_created"),P=null!==localStorage.getItem("room_code")?localStorage.getItem("room_code"):"";function R(){var e=Object(a.useState)(L),n=Object(p.a)(e,2),t=n[0],o=n[1],i=Object(a.useState)(z),c=Object(p.a)(i,2),s=c[0],d=c[1],u=Object(a.useState)(P),m=Object(p.a)(u,2),b=m[0],v=m[1],w=Object(a.useState)(""),y=Object(p.a)(w,2),S=y[0],k=y[1],_=Object(a.useState)(""),I=Object(p.a)(_,2),E=I[0],R=I[1],A=Object(a.useState)(false),F=Object(p.a)(A,2),U=F[0],J=F[1],G=Object(l.f)();return Object(a.useEffect)((function(){t?s?console.log("blank"):(console.log("creating user"),x(d)):(console.log("getting session_key"),f(o))}),[t,s]),Object(a.useEffect)((function(){"208"===E?J(!0):""!==E&&window.open(E,"_self")}),[E]),Object(a.useEffect)((function(){""!==b&&(console.log("Room code in LocalStorage!"),G.push("room/"+b)),U&&G.push("config-room")}),[U,G,b]),Object(T.jsx)(r.a.Fragment,{children:Object(T.jsxs)(X,{children:[Object(T.jsx)(Z,{children:Object(T.jsx)(ee,{src:C,alt:"Logo"})}),Object(T.jsxs)(ne,{children:[Object(T.jsx)(te,{children:"\xa1Bienvenido!"}),Object(T.jsxs)(oe,{action:"",children:[Object(T.jsx)(ae,{onChange:function(){return function(){var e=document.getElementById("code");console.log(e.value),k(e.value)}()},id:"code",type:"text",placeholder:"C\xf3digo"}),Object(T.jsx)(re,{type:"submit",onClick:function(){""!==S&&(console.log("Join From Room Code"),function(e,n){var t=new URL([g,h,"participants","join"].join("/")),o=j("POST");o.body=JSON.stringify({code:n}),fetch(t,o).then((function(e){return 201===e.status?(console.log("Successfully joined"),{code:n}):208===e.status?(console.log("User is already in room. Leave first!"),e.json()):void 0})).then((function(n){void 0===n?new Error("API !=! Error reported by backend"):(console.log(n),localStorage.setItem("room_code",n.code),e(n.code))}))}(v,S))},value:"\u25b6"})]}),Object(T.jsx)(B,{onClick:function(){return console.log("CLICK!"),void("true"===localStorage.getItem("spotify_authenticated")?(console.log("go to config-room"),G.push("config-room")):(localStorage.setItem("next","config-room"),O(R)))},children:"Nueva Sala"})]})]})})}var A,F,U,J,G,N,V,H,D,K,Y,$,q,M,Q,W,X=u.c.main(v||(v=Object(d.a)(["\n  padding: 15vw;\n  height: 100vh;\n  display: grid;\n  grid-template-rows: 50% 50%;\n\n  @media screen and (orientation: landscape) and (max-width: 900px) {\n    padding: 5vw 10vw;\n    width: 100vw;\n    height: 100vh;\n    display: grid;\n    grid-template-rows: 1fr;\n    grid-template-columns: 50% 50%;\n    place-items: center center;\n  }\n\n  @media screen and (min-width: 1024px) {\n    padding: 5vw 0 0;\n    height: 100vh;\n    display: grid;\n    grid-template-rows: 50% 50%;\n  }\n\n  @media screen and (min-width: 1024px) and (orientation: portrait) {\n    padding: 15vw;\n    height: 100vh;\n    display: grid;\n    grid-template-rows: 50% 50%;\n  }\n"]))),Z=u.c.div(w||(w=Object(d.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]))),ee=u.c.img(y||(y=Object(d.a)(["\n  width: 100%;\n  max-width: 300px;\n\n  @media screen and (orientation: landscape) and (max-width: 900px) {\n    padding: 0 10vw 0 0;\n  }\n"]))),ne=u.c.section(S||(S=Object(d.a)(["\n  display: grid;\n  grid-template-rows: 30% 30% 30%;\n  place-items: center center;\n  max-height: 300px;\n\n  @media screen and (orientation: landscape) and (max-width: 900px) {\n    height: 80%;\n  }\n\n  @media screen and (min-width: 1024px) and (orientation: portrait) {\n    .main__container {\n      grid-template-rows: 20% 20% 20% 40%;\n      place-items: center center;\n    }\n\n    @media screen and (min-width: 1024px) and (orientation: landscape) {\n      max-height: 400px;\n    }\n  }\n"]))),te=u.c.h1(k||(k=Object(d.a)(["\n  color: white;\n  font-size: clamp(2.5rem, 8vw, 4rem);\n  text-align: center;\n  font-family: var(--font-bungee-bold);\n\n  @media screen and (orientation: landscape) and (max-width: 900px) {\n    font-size: clamp(2.5rem, 8vh, 4rem);\n  }\n"]))),oe=u.c.form(_||(_=Object(d.a)(["\n  display: grid;\n  grid-template-columns: 70% 30%;\n"]))),ae=u.c.input(I||(I=Object(d.a)(["\n  width: 100%;\n  height: 100%;\n  padding: 0 10px;\n  border-radius: 10px;\n  font-size: 1.8rem;\n  text-align: center;\n\n  &:focus {\n    outline: none;\n  }\n\n  &:active {\n    outline: none;\n  }\n\n  &:hover {\n    outline: none;\n  }\n"]))),re=u.c.input(E||(E=Object(d.a)(["\n  width: 50px;\n  height: 40px;\n  padding: 0 10px;\n  border-radius: 10px;\n  color: white;\n  font-size: 2rem;\n  background-color: var(--purple);\n  border: none;\n  position: relative;\n  transition: 0.3s;\n  box-shadow: 2px 2px 10px 5px #00000033;\n  cursor: pointer;\n  display: flex;\n  justify-self: flex-end;\n  justify-content: center;\n\n  &:active {\n    transform: scale(0.9);\n  }\n\n  &:hover {\n    filter: brightness(120%);\n  }\n"]))),ie={},ce=null===localStorage.getItem("room_code")?"":localStorage.getItem("room_code");function se(){var e=Object(a.useState)(false),n=Object(p.a)(e,2),t=n[0],o=n[1],i=Object(a.useState)(2),c=Object(p.a)(i,2),s=c[0],d=c[1],u=Object(a.useState)(ce),f=Object(p.a)(u,2),x=f[0],O=f[1],v=Object(a.useState)(ie),w=Object(p.a)(v,2),y=w[0],S=w[1],k=Object(a.useState)(true),_=Object(p.a)(k,2),I=_[0],E=_[1],B=Object(l.f)(),C="true"===localStorage.getItem("spotify_authenticated"),L=Object(a.useState)(false),z=Object(p.a)(L,2),P=z[0],R=z[1];function A(){var e=document.getElementById("votes");e.addEventListener("input",(function(){this.value.length>2&&(this.value=this.value.slice(0,2))})),d(/^\d+$/.test(e.value)?e.value:2)}return Object(a.useEffect)((function(){C&&""===x&&(0===Object.keys(y).length&&y.constructor===Object?function(e){var n=new URL([g,m,"details"].join("/")),t=j("GET");console.log("getting user details"),fetch(n,t).then((function(e){return e.json()})).then((function(n){console.log(n),e(n)})).catch((function(e){return new Error(b+e)}))}(S):"premium"===y.spotify_user.product?console.log("user is premium"):(console.log("user is not premium"),E(!1)))}),[y,C,x]),Object(a.useEffect)((function(){var e=new AbortController;return P&&function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new URL([g,h,"create"].join("/")),r=j("POST");r.body=JSON.stringify({votes_to_skip:t,guests_can_pause:o}),null!==n&&(r.signal=n.signal),fetch(a,r).then((function(e){return console.log(e),200===e.status||201===e.status?(console.log("201 ok"),e.json()):208===e.status?(console.log("already in room"),e.json()):void console.log("error")})).then((function(n){console.log("data "+n.code),void 0===n?new Error("API !=! Error reported by backend"):(localStorage.setItem("room_code",n.code),e(n.code))})).catch((function(e){"AbortError"===e.name?console.log("Aborting"):console.log("error"+e)}))}(O,e,s,t),""!==x&&B.push("room/"+localStorage.getItem("room_code")),function(){e.abort()}}),[P,s,t,x,B]),C||B.push("/"),Object(T.jsxs)(r.a.Fragment,{children:[P&&Object(T.jsx)("h1",{children:"Loading"}),I&&!P&&C&&Object(T.jsxs)(le,{children:[Object(T.jsx)(de,{children:"Configuraci\xf3n de la sala"}),Object(T.jsxs)(pe,{children:[Object(T.jsx)(ue,{children:"Controles de los invitados"}),Object(T.jsxs)(ge,{children:[Object(T.jsx)(me,{type:"radio",name:"controls",id:"control",onChange:function(){return o(!0)}}),Object(T.jsx)(he,{htmlFor:"control",children:"Reproducir / Pausar"}),Object(T.jsx)(me,{type:"radio",name:"controls",id:"nocontrol",onChange:function(){return o(!1)}}),Object(T.jsx)(he,{htmlFor:"nocontrol",children:"Ninguno"})]})]}),Object(T.jsxs)(be,{children:[Object(T.jsx)(ue,{children:"Votos para saltar canci\xf3n"}),Object(T.jsx)(je,{id:"votes",onChange:A,type:"number",placeholder:2})]}),Object(T.jsx)(fe,{onClick:function(){return R(!0)},children:"\xa1Crear sala!"}),Object(T.jsx)(xe,{onClick:function(){return B.push("/")},children:"Regresar"})]}),!I&&!P&&C&&Object(T.jsxs)(Oe,{children:[Object(T.jsx)(ve,{children:"\ud83d\ude1e"}),Object(T.jsx)(we,{children:"Lo sentimos, esta aplicaci\xf3n solo funciona con una cuenta premium."}),Object(T.jsx)(ye,{as:"a",href:"https://www.spotify.com/mx/premium/",children:"\xa1S\xe9 premium ahora!"}),Object(T.jsx)(Se,{onClick:function(){return B.push("/")},children:"Return"})]})]})}var le=u.c.main(A||(A=Object(d.a)(['\n  display: grid;\n  padding: 15vh 0;\n  height: 100vh;\n  max-height: 900px;\n  width: 100%;\n  max-width: 300px;\n  margin: 0 auto;\n  grid-template-rows: 100px repeat(2, 25%) repeat(2, 15%);\n  grid-template-areas:\n    "Title"\n    "Controls"\n    "Votes"\n    "ButtonOne"\n    "ButtonTwo";\n  gap: 10px;\n  position: relative;\n\n  @media screen and (max-width: 900px) and (orientation: landscape) {\n    padding: 0;\n    margin: auto;\n    grid-template-columns: repeat(2, minmax(10%, 1fr));\n    width: 100%;\n    max-height: 500px;\n    min-width: 90vw;\n    grid-template-rows: 100px 25%;\n    grid-template-areas: "Title Title" "Controls Votes" "ButtonOne ButtonTwo";\n    place-items: center center;\n  }\n']))),de=u.c.h1(F||(F=Object(d.a)(["\n  font-size: clamp(2.5rem, 8vw, 3rem);\n  line-height: clamp(2.8rem, 8vw, 3.3rem);\n  font-family: var(--font-bungee-bold);\n  color: white;\n  text-align: center;\n  grid-area: Title;\n"]))),pe=u.c.div(U||(U=Object(d.a)(["\n  text-align: center;\n  grid-area: Controls;\n"]))),ue=u.c.h2(J||(J=Object(d.a)(["\n  color: white;\n  font-size: 2rem;\n  line-height: 2.3rem;\n  font-family: var(--font-bungee-bold);\n"]))),ge=u.c.div(G||(G=Object(d.a)(["\n  display: flex;\n  margin-top: 20px;\n  justify-content: space-evenly;\n"]))),me=u.c.input(N||(N=Object(d.a)(["\n  display: none;\n\n  &:checked + label {\n    padding: 5px 10px;\n    background: var(--purple);\n    box-shadow: 0 3px 10px 1px #00000033;\n    font-weight: bold;\n  }\n\n  &:checked + label::before {\n    display: none;\n  }\n"]))),he=u.c.label(V||(V=Object(d.a)(['\n  color: white;\n  font-size: 1.6rem;\n  position: relative;\n  padding: 5px 5px 5px 30px;\n  cursor: pointer;\n  border-radius: 5px;\n  transition: 0.3s;\n\n  &::before {\n    content: "";\n    background: white;\n    height: 20px;\n    width: 20px;\n    position: absolute;\n    top: 0;\n    left: 0;\n    border-radius: 50%;\n    border: 2px solid var(--purple);\n  }\n']))),be=u.c.div(H||(H=Object(d.a)(["\n  text-align: center;\n  grid-area: Votes;\n"]))),je=u.c.input(D||(D=Object(d.a)(["\n  text-align: center;\n  margin-top: 20px;\n  background: transparent;\n  border: none;\n  width: 40px;\n  padding: 5px;\n  color: white;\n  font-size: 1.8rem;\n  border-bottom: 1px solid white;\n\n  &:focus {\n    outline: none;\n  }\n\n  &::placeholder {\n    color: white;\n    opacity: 0.6;\n  }\n"]))),fe=Object(u.c)(B)(K||(K=Object(d.a)(["\n  grid-area: ButtonOne;\n  padding: 10px 0;\n"]))),xe=Object(u.c)(B)(Y||(Y=Object(d.a)(["\n  max-width: 150px;\n  display: block;\n  grid-area: ButtonTwo;\n"]))),Oe=u.c.main($||($=Object(d.a)(['\n  padding: 5vh 0;\n  display: grid;\n  grid-template-rows: 150px auto repeat(2, 100px);\n  max-height: 800px;\n  place-items: center center;\n  grid-template-areas:\n    "SadFace"\n    "Title"\n    "BuySpotify"\n    "BackButton";\n  grid-gap: 20px;\n\n  @media screen and (max-width: 900px) and (orientation: landscape) {\n    grid-template-rows: 150px 100px;\n    grid-template-areas:\n      "Title Title"\n      "BuySpotify BackButton";\n    grid-gap: 20px;\n  }\n']))),ve=u.c.span(q||(q=Object(d.a)(["\n  font-size: 10rem;\n  text-align: center;\n  grid-area: SadFace;\n\n  @media screen and (max-width: 900px) and (orientation: landscape) {\n    display: none;\n  }\n"]))),we=Object(u.c)(de)(M||(M=Object(d.a)(["\n  grid-area: Title;\n  line-height: clamp(3rem, 8vw, 4rem);\n"]))),ye=Object(u.c)(B)(Q||(Q=Object(d.a)(["\n  grid-area: BuySpotify;\n  animation: animation 4s ease-in-out infinite;\n\n  @keyframes animation {\n    0% {\n      transform: scale(1);\n    }\n    50% {\n      transform: scale(1.1);\n      filter: brightness(105%);\n    }\n    100% {\n      transform: scale(1);\n    }\n  }\n\n  @media screen and (max-width: 900px) and (orientation: landscape) {\n    @keyframes animation {\n      0% {\n        transform: scale(0.8);\n      }\n      50% {\n        transform: scale(0.95);\n        filter: brightness(105%);\n      }\n      100% {\n        transform: scale(0.8);\n      }\n    }\n  }\n"]))),Se=Object(u.c)(B)(W||(W=Object(d.a)(["\n  max-width: 150px;\n  display: block;\n  grid-area: BackButton;\n\n  @media screen and (max-width: 900px) and (orientation: landscape) {\n    transform: scale(0.8);\n  }\n"]))),ke=null!==localStorage.getItem("session_key"),_e="true"===localStorage.getItem("user_created");function Ie(){var e=Object(a.useState)(ke),n=Object(p.a)(e,2),t=n[0],o=n[1],r=Object(a.useState)(_e),i=Object(p.a)(r,2),c=i[0],s=i[1],l=Object(a.useState)("myhome.com"),d=Object(p.a)(l,2),u=d[0],g=d[1];return Object(a.useEffect)((function(){t?c?(console.log("getting auth url"),O(g)):(console.log("creating user"),x(s)):(console.log("getting session_key"),f(o))}),[t,c]),Object(T.jsx)("div",{children:Object(T.jsx)("h3",{children:Object(T.jsx)("a",{href:u,children:u})})})}function Ee(){console.log("loading");var e=localStorage.getItem("next"),n=new URL(window.location.href),t=n.searchParams.get("session_key").toString(),o=n.searchParams.get("status").toString(),a=Object(l.f)();return localStorage.getItem("session_key")!==t&&localStorage.setItem("session_key",t),localStorage.removeItem("next"),"401"===o?a.push("/"):"200"===o?(localStorage.setItem("spotify_authenticated","true"),a.push(e)):a.push("error"),Object(T.jsx)(r.a.Fragment,{children:Object(T.jsx)("h2",{children:"please wait"})})}var Be;function Ce(){var e=Object(a.useState)(true),n=Object(p.a)(e,2),t=n[0],o=(n[1],Object(l.f)()),i=window.location.pathname.split("/");return(i[2]?i[2].toString():void 0)!==localStorage.getItem("room_code")&&null!==localStorage.getItem("room_code")&&o.push(localStorage.getItem("room_code")),Object(T.jsx)(r.a.Fragment,{children:t&&Object(T.jsxs)(r.a.Fragment,{children:[Object(T.jsxs)("h1",{children:["Your code: ",localStorage.getItem("room_code")]}),Object(T.jsx)("br",{}),Object(T.jsx)(B,{onClick:function(){return function(){var e=new URL([g,h,"participants","leave"].join("/")),n=j("DELETE");fetch(e,n).catch((function(e){console.log("Error "+e)}))}(),localStorage.removeItem("room_code"),void o.push("/")},children:"Leave room"})]})})}var Te,Le=Object(u.b)(Be||(Be=Object(d.a)(['\n  :root {\n    --font-bungee-bold: "Bungee", cursive;\n    --font-bungee-light: "Bungee Hairline", cursive;\n    --font-bungee-shade: "Bungee Shade", cursive;\n    --blue: #23049d;\n    --purple: #aa2ee6;\n    --pink: #ff79cd;\n    --gradient: linear-gradient(\n      90deg,\n      rgba(35, 4, 157, 1) 0%,\n      rgba(170, 46, 230, 1) 50%,\n      rgba(255, 121, 205, 1) 100%\n    );\n  }\n']))),ze=Object(u.a)(Te||(Te=Object(d.a)(["\n\n    ",";\n\n    * {\n        box-sizing: border-box;\n        padding: 0;\n        margin: 0;\n    }\n\n    html {\n        font-size: 62.5%;\n    }\n\n    body {\n        background: var(--gradient);\n    }\n\n    ::placeholder {\n        color: #000000;\n        font-family: sans-serif;\n        font-size: 1.8rem;\n        text-align: center;\n    }\n"])),Le);function Pe(){return Object(T.jsxs)(s.a,{children:[Object(T.jsx)(ze,{}),Object(T.jsxs)(l.c,{children:[Object(T.jsx)(l.a,{exact:!0,path:"/",component:R}),Object(T.jsx)(l.a,{exact:!0,path:"/test-api",component:Ie}),Object(T.jsx)(l.a,{exact:!0,path:"/config-room",component:se}),Object(T.jsx)(l.a,{exact:!0,path:"/redirect-from-api",component:Ee}),Object(T.jsx)(l.a,{exact:!0,path:"/room/:room_code",component:Ce})]})]})}var Re=document.getElementById("app");c.a.render(Object(T.jsx)(Pe,{}),Re)}},[[39,1,2]]]);
//# sourceMappingURL=main.7abbd61b.chunk.js.map